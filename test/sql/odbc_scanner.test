# name: test/sql/odbc_scanner.test
# description: test odbc_scanner extension
# group: [odbc_scanner]

#statement ok
#PRAGMA threads=1

# Before we load the extension, this will fail
statement error
SELECT * FROM odbc_query()
----
Catalog Error: Table Function with name odbc_query does not exist!

# Require statement will ensure the extension is loaded from now on
require odbc_scanner

# Open ODBC connection

statement ok
SET VARIABLE conn = odbc_connect('Driver={DuckDB Driver};')

query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT unnest([41, 42, 43])')
----
41
42
43

# todo: columns
query II
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT ''foo'', 42')
----
foo	42

statement ok
SELECT odbc_close(getvariable('conn'))
