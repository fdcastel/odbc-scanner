# name: test/sql/firebird/03_integer.test
# description: test for Firebird INTEGER types (SMALLINT, INTEGER, BIGINT)
# group: [firebird_integer]

require odbc_scanner

require-env FIREBIRD_AVAILABLE

statement ok
SET VARIABLE conn = odbc_connect('ODBCSCANNER_DEBUG_CONN_STRING_ENV_VAR=ODBC_CONN_STRING')

# SMALLINT test
query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT CAST(100 AS SMALLINT) FROM rdb$database')
----
100

query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT CAST(-32768 AS SMALLINT) FROM rdb$database')
----
-32768

query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT CAST(32767 AS SMALLINT) FROM rdb$database')
----
32767

# INTEGER test
query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT CAST(123456 AS INTEGER) FROM rdb$database')
----
123456

query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT CAST(-2147483648 AS INTEGER) FROM rdb$database')
----
-2147483648

query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT CAST(2147483647 AS INTEGER) FROM rdb$database')
----
2147483647

# BIGINT test
query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT CAST(9223372036854775807 AS BIGINT) FROM rdb$database')
----
9223372036854775807

query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT CAST(-9223372036854775808 AS BIGINT) FROM rdb$database')
----
-9223372036854775808

# Hexadecimal format test for INTEGER
query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT 0x7FFFFFFF FROM rdb$database')
----
2147483647

# Hexadecimal format test for BIGINT  
query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT 0x7FFFFFFFFFFFFFFF FROM rdb$database')
----
9223372036854775807

# NULL values
query I
SELECT * FROM odbc_query(getvariable('conn'), 'SELECT CAST(NULL AS INTEGER) FROM rdb$database')
----
NULL

# With parameters
query I
SELECT * FROM odbc_query(getvariable('conn'), 
  'SELECT CAST(? AS INTEGER) FROM rdb$database',
  params=row(42::INTEGER))
----
42

# Note: INT128 type requires Firebird 4.0+ and is not tested here
# INT128 range: -2^127 to 2^127-1

statement ok
SELECT odbc_close(getvariable('conn'))
